<!DOCTYPE html>
<html>
<head>
  <title>Video + Power BI xen kẽ</title>
  <style>
    html, body {
      margin:0; padding:0; height:100%;
      background:black; overflow:hidden;
    }
    iframe {
      width:100%; height:100%; border:none;
    }
  </style>
</head>
<body>

  <!-- Video đầu tiên -->
  <iframe
    id="player"
    src="https://player.vimeo.com/video/1119332063?autoplay=1&muted=1"
    allow="autoplay; fullscreen"
    allowfullscreen
  ></iframe>

  <script src="https://player.vimeo.com/api/player.js"></script>
  <script>
    // Playlist: video (Vimeo) và báo cáo (Power BI)
    const playlist = [
      {type:"vimeo", id:"1119332063"},
             {type:"powerbi", url:"https://app.powerbi.com/view?r=eyJrIjoiZWZlNzQwMjQtOWVjZC00MzhkLWE0ODctMjExMjk3NTVlOTQ4IiwidCI6IjQ2NmQwOWI5LTRkNGItNGQ1MC1iMmY1LTM3YTNjMWY3ZWI4YiIsImMiOjEwfQ%3D%3D"},
      //20-10-10
      {type:"powerbi", url:"https://app.powerbi.com/view?r=eyJrIjoiZDRlZTM3MWItZWU5YS00OTJjLThmZDAtODkwMjg0YmZiYjJlIiwidCI6IjQ2NmQwOWI5LTRkNGItNGQ1MC1iMmY1LTM3YTNjMWY3ZWI4YiIsImMiOjEwfQ%3D%3D"},
      //muc bon
         {type:"powerbi", url:"https://app.powerbi.com/view?r=eyJrIjoiNGY2OTk2ZmEtYzViOC00Y2Y1LWJiYmQtZDIyNzhhYmZmMDhhIiwidCI6IjQ2NmQwOWI5LTRkNGItNGQ1MC1iMmY1LTM3YTNjMWY3ZWI4YiIsImMiOjEwfQ%3D%3D"},
      //2-2-1
       {type:"powerbi", url:"https://app.powerbi.com/view?r=eyJrIjoiNjM4Yjc3NDgtZGU5OS00MjZlLTk2NGItZWEwMjBiODljMzY0IiwidCI6IjQ2NmQwOWI5LTRkNGItNGQ1MC1iMmY1LTM3YTNjMWY3ZWI4YiIsImMiOjEwfQ%3D%3D"},
     // dauboc
      {type:"powerbi", url:"https://app.powerbi.com/view?r=eyJrIjoiMTk0ZDVjNGYtOGFiMS00M2M5LThiZDMtMGU4ZjNjNzNkNzAwIiwidCI6IjQ2NmQwOWI5LTRkNGItNGQ1MC1iMmY1LTM3YTNjMWY3ZWI4YiIsImMiOjEwfQ%3D%3D"},
      //2-1-2
      {type:"powerbi", url:"https://app.powerbi.com/view?r=eyJrIjoiMDg0OWRiYjctNTA1NS00YzZjLWE0ZGEtN2MxYjU3MGU3M2FkIiwidCI6IjQ2NmQwOWI5LTRkNGItNGQ1MC1iMmY1LTM3YTNjMWY3ZWI4YiIsImMiOjEwfQ%3D%3D"},
      //phutro
        {type:"powerbi", url:"https://app.powerbi.com/view?r=eyJrIjoiZjg3OWM3NTAtOWViZC00YTBhLWExMzMtNjc4MmE0YWVlM2FiIiwidCI6IjQ2NmQwOWI5LTRkNGItNGQ1MC1iMmY1LTM3YTNjMWY3ZWI4YiIsImMiOjEwfQ%3D%3D"},
      //4-1-1
        {type:"powerbi", url:"https://app.powerbi.com/view?r=eyJrIjoiODIxNGVhYmMtNjYzYS00N2I0LWIzZjYtNTU1YzUyNzM0ZWMxIiwidCI6IjQ2NmQwOWI5LTRkNGItNGQ1MC1iMmY1LTM3YTNjMWY3ZWI4YiIsImMiOjEwfQ%3D%3D"},
      //ETP
        {type:"powerbi", url:"https://app.powerbi.com/view?r=eyJrIjoiMGQwZjUyZDItOGJjNy00MjlmLWFkODUtZjg3ZTRiOWJlZTg0IiwidCI6IjQ2NmQwOWI5LTRkNGItNGQ1MC1iMmY1LTM3YTNjMWY3ZWI4YiIsImMiOjEwfQ%3D%3D"}
      //KPI
           {type:"powerbi", url:"https://app.powerbi.com/view?r=eyJrIjoiY2Y3MGFiOTQtYjgxOS00MTA2LWI2YWEtMTZmZDcwZTcyMDJiIiwidCI6IjQ2NmQwOWI5LTRkNGItNGQ1MC1iMmY1LTM3YTNjMWY3ZWI4YiIsImMiOjEwfQ%3D%3D"},
      //1-1-1
          {type:"powerbi", url:"https://app.powerbi.com/view?r=eyJrIjoiMWFmYTM3ZTgtYTlmMy00YjQxLTljNDctNWQ2ZmE5MjAyNDk2IiwidCI6IjQ2NmQwOWI5LTRkNGItNGQ1MC1iMmY1LTM3YTNjMWY3ZWI4YiIsImMiOjEwfQ%3D%3D"},
      //20-20-15
              {type:"powerbi", url:"https://app.powerbi.com/view?r=eyJrIjoiYzU4NzZjMDItMzcwNS00OTBiLWI0NjAtN2ZiMGI0ZDc1OTk4IiwidCI6IjQ2NmQwOWI5LTRkNGItNGQ1MC1iMmY1LTM3YTNjMWY3ZWI4YiIsImMiOjEwfQ%3D%3D"}
      //15520

    ];

    let index = 0;
    let player = new Vimeo.Player(document.getElementById("player"));
    let timer, refresher;

    // Gắn sự kiện ended cho video
    player.on("ended", next);
    player.ready().then(() => player.play());
    function load(item){
      clearTimeout(timer);
      clearInterval(refresher);
      const f = document.getElementById("player");

      if(item.type === "vimeo"){
        // Nếu player chưa có (do trước đó là Power BI) thì tạo mới
        if(!player){
          f.src = `https://player.vimeo.com/video/${item.id}?autoplay=1&muted=1`;
          player = new Vimeo.Player(f);
          player.on("ended", next);
        } else {
          // Đổi video trong player
          player.loadVideo(item.id).then(() => player.play());
        }
      } else if(item.type === "powerbi"){
        // Hủy player để chuyển sang iframe Power BI
        player = null;
        f.src = item.url;
        // Sau 5 phút tự next
        timer = setTimeout(next, 5*60*1000);
        // Cứ 60 giây reload lại (reset Play Axis)
        refresher = setInterval(() => { f.src = item.url }, 90*1000);
      }
    }

    function next(){
      index = (index + 1) % playlist.length;
      load(playlist[index]);
    }
  </script>

</body>
</html>






