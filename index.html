<!DOCTYPE html>
<html>
<head>
  <title>Video + Power BI xen kẽ</title>
  <style>
    html, body {margin:0;padding:0;height:100%;background:black;overflow:hidden;}
    iframe {width:100%;height:100%;border:none;}
  </style>
</head>
<body>

  <iframe id="player" allow="autoplay; fullscreen" allowfullscreen></iframe>

  <script src="https://player.vimeo.com/api/player.js"></script>
  <script>
    // Playlist: video Vimeo và Power BI
    const playlist = [
      {type:"vimeo", id:"1119332063"},
      {type:"vimeo", id:"1119332013"},
      {type:"vimeo", id:"1119005050"}
      // {type:"powerbi", url:"https://app.powerbi.com/view?r=xxxx"}
    ];

    let i = 0, timer, refresher, player;

    function load(item){
      clearTimeout(timer);
      clearInterval(refresher);

      const f = document.getElementById("player");

      if(item.type === "vimeo"){
        if(!player){
          // Tạo player một lần duy nhất
          player = new Vimeo.Player(f, {
            id: item.id,
            autoplay: true,
            muted: true
          });
          player.on("ended", next); // Khi hết video → next
        } else {
          // Chỉ đổi video
          player.loadVideo(item.id).then(() => player.play());
        }
      } else if(item.type === "powerbi"){
        // Với Power BI thì gán src
        player = null; // xoá player tạm để khi quay lại video tạo lại
        f.src = item.url;
        timer = setTimeout(next, 5*60*1000); // 5 phút đổi
        refresher = setInterval(() => { f.src = item.url }, 30*1000); // 30s refresh
      }
    }

    function next(){
      i = (i+1) % playlist.length;
      load(playlist[i]);
    }

    // bắt đầu
    load(playlist[i]);
  </script>

</body>
</html>
